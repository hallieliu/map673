<!DOCTYPE html>
<html>

<head>
    <title>MAP 673 Module 06 CartoDB Starter Template</title>
    <meta name="viewport" content="initial-scale=1.0, user-scalable=no" />
    <meta http-equiv="content-type" content="text/html; charset=UTF-8" />

    <link rel="stylesheet" href="http://libs.cartocdn.com/cartodb.js/v3/3.15/themes/css/cartodb.css" />

    <style>
        html,
        body,
        #map {
            height: 100%;
            padding: 0;
            margin: 0;
            background-color: ghostwhite;
        }
    </style>
</head>

<body>

    <div id="map"></div>

    <script src="http://libs.cartocdn.com/cartodb.js/v3/3.15/cartodb.js"></script>
    <script type="cartocss/html" id="locations-styles">
    #pls_2013_locations{
        marker-fill-opacity: 0.3;
        marker-line-color: #3B007F;
        marker-line-width: 1;
        marker-line-opacity: 0.2;
        marker-placement: point;
        marker-type: ellipse;
        marker-width: 3.5;
        marker-fill: #A53ED5;
        marker-allow-overlap: true;
        marker-comp-op: darken;
    }
    </script>
    <script type="cartocss/html" id="states-styles">
    #ne_50m_admin_1_states{
        polygon-fill: #FF6600;
        polygon-opacity: 0;
        line-color: #FFF;
        line-width: 1;
        line-opacity: .6;
    }
    </script>
    <script type="cartocss/html" id="land-style">
    #ne_50m_land{
        polygon-fill: #dddddd;
        polygon-opacity: 1;
        line-color: #FFF;
        line-width: 1.5;
        line-opacity: 1;
    }
    </script>
    
    <script>
        var map = new L.Map("map", {
            center: [0, 0], // note the map is centered closer to 0,0
            zoom: 4.5
        });

        var sourceObject = {
            user_name: 'hallieliu',
            type: 'cartodb',
            sublayers: [
                
                // landmass
                 {sql: "SELECT ST_Transform(the_geom, 102008) AS the_geom_webmercator FROM ne_50m_land",

                    cartocss: $("#land-style").text()
                },
                
                // state borders
                 {sql: "SELECT ST_Transform(the_geom, 102008) AS the_geom_webmercator FROM ne_50m_admin_1_states",

                    cartocss: $("#states-styles").text()
                },
                
                // library locations
                {sql: "SELECT ST_Transform(the_geom, 102008) AS the_geom_webmercator FROM pls_2013_locations",

                    cartocss: $("#locations-styles").text()
                }
            ]
        }

        //var url = 'https://hallieliu.cartodb.com/api/v2/viz/18a71106-2049-11e6-809b-0e674067d321/viz.json';

        cartodb.createLayer(map, sourceObject).addTo(map);
        //console.log(map);
    </script>
</body>

</html>